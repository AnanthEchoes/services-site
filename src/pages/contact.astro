---
import "../styles/global.css";
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Echoes Services">
  <div class="min-h-screen flex items-center justify-center p-4">
    <!-- Card container -->
    <div class="bg-white shadow-lg rounded-2xl p-8 w-full max-w-lg">
      <h1 class="text-2xl font-bold mb-6 text-blue-900 text-center">
        Contact us
      </h1>

      <!-- Form -->
      <form id="contact-form" action="/contact" method="POST" class="space-y-4">
        <div>
          <label class="block text-sm text-blue-900 font-bold mb-1">Name</label>
          <input
            name="name"
            required
            placeholder="Enter your name"
            class="w-full bg-white text-black placeholder-gray-400 border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
          />
        </div>

        <div>
          <label class="block text-blue-900 text-sm font-bold mb-1"
            >Email</label
          >
          <input
            type="email"
            name="email"
            placeholder="Enter your Email"
            required
            class="w-full bg-white text-black placeholder-gray-400 border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
          />
        </div>

        <div>
          <label class="block text-blue-900 text-sm font-bold mb-1"
            >Message</label
          >
          <textarea
            name="message"
            required
            placeholder="Enter your message"
            rows="4"
            class="w-full bg-white text-black placeholder-gray-400 border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
          ></textarea>
        </div>

        <!-- Turnstile widget -->
        <div
          class="cf-turnstile"
          data-sitekey={import.meta.env.PUBLIC_TURNSTILE_SITEKEY}
        >
        </div>

        <button
          type="submit"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition"
        >
          Send
        </button>
      </form>
    </div>
  </div>

  <!-- Optional: AJAX submit for nicer UX -->
  <script>
    (function () {
      const form = document.getElementById("contact-form");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const btn = form.querySelector('button[type="submit"]');
        btn.disabled = true;
        const formData = new FormData(form);
        try {
          const res = await fetch("/contact", {
            method: "POST",
            body: formData,
          });
          const json = await res.json();
          if (res.ok) {
            alert("Thanks â€” message sent!");
            form.reset();
          } else {
            alert("Verification failed: " + (json["error"] || "unknown"));
          }
        } catch (err) {
          console.error(err);
          alert("Network error");
        } finally {
          btn.disabled = false;
        }
      });
    })();
  </script>
</BaseLayout>
